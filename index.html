<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="icon" type="image/png" href="/arx_favicon.png">
    <link rel="shortcut icon" type="image/png" href="/arx_favicon.png">
    <title>Get Your Business Sale Readiness Score in 3 Minutes | AI-Powered Assessment | ARX Business Brokers</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Google reCAPTCHA v3 -->
    <script src="https://www.google.com/recaptcha/api.js?render=6LdrH68rAAAAADuJOKxj-FLpKB8fUNFX-I6mYeAA" async defer></script>
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23SV7KW5WM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23SV7KW5WM', {
            // Enhanced ecommerce and cross-domain tracking
            'custom_map': {
                'custom_parameter_1': 'assessment_score',
                'custom_parameter_2': 'industry'
            }
        });
    </script>
    
    <!-- Facebook Pixel disabled until proper ID is configured -->
    <!--
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', 'YOUR_PIXEL_ID');
        fbq('track', 'PageView');
    </script>
    -->
    
    <style>
        :root {
            /* ARX Brand Colors */
            --bright-white: #FAFAFA;
            --light-stone-white: #F0F1F2;
            --cool-gray: #B3B6B8;
            --hyperlink-blue: #416EA6;
            --dark-anchor: #101620;
            
            /* Legacy colors (to be phased out) */
            --arx-navy: #0f172a;
            --arx-blue: #1e293b;
            --arx-orange: #ea580c;
            --arx-light: #f8fafc;
            --arx-gray: #64748b;
        }
        body {
            font-family: 'Open Sans', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Inter', sans-serif;
        }
        .progress-bar {
            transition: width 0.3s ease;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .btn-primary {
            background: #000000;
            transition: all 0.2s;
        }
        .btn-primary:hover {
            background: #1a1a1a;
        }
        .logo-text {
            font-family: 'Inter', 'Arial Black', sans-serif;
            font-weight: 900;
            letter-spacing: -0.05em;
        }
        /* Prevent sticky focus states on mobile */
        .answer-btn:focus {
            outline: none;
        }
        .answer-btn:active {
            transform: scale(0.98);
        }
        @media (hover: hover) {
            /* Only apply hover styles on devices that support hover */
            .answer-btn:hover {
                border-color: currentColor;
            }
        }
        /* Brand utility classes */
        .bg-dark-anchor {
            background-color: var(--dark-anchor);
        }
        .bg-bright-white {
            background-color: var(--bright-white);
        }
        .bg-light-stone-white {
            background-color: var(--light-stone-white);
        }
        .text-cool-gray {
            color: var(--cool-gray);
        }
        .text-hyperlink-blue {
            color: var(--hyperlink-blue);
        }
        .text-dark-anchor {
            color: var(--dark-anchor);
        }
        .text-bright-white {
            color: var(--bright-white);
        }
        .bg-hyperlink-blue {
            background-color: var(--hyperlink-blue);
        }
        .font-headline {
            font-family: 'Inter', sans-serif;
        }
        .font-body {
            font-family: 'Open Sans', sans-serif;
        }
        
        /* Remove tap highlight on mobile */
        button {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* Loading spinner animation */
        .loading-spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #ffffff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .btn-loading {
            opacity: 0.8;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen" tabindex="-1">
    <!-- Header -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="container max-w-6xl mx-auto px-4">
            <div class="flex items-center justify-between h-20">
                <div class="flex items-center">
                    <img src="/arx_website_blueblack.webp" alt="ARX Business Brokers" style="height: 50px; width: auto;" 
                         onerror="this.style.display='none'; document.getElementById('fallbackLogo').style.display='block';">
                    <div id="fallbackLogo" style="display:none;" class="logo-text text-2xl text-slate-900 lowercase font-bold">arx</div>
                </div>
                <div class="text-right">
                    <div class="text-sm font-medium text-slate-900">Business Sales Readiness Assessment</div>
                    <div class="text-xs text-slate-600">Free • Confidential • 3 minutes</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="bg-gray-200 h-2 relative">
        <div class="max-w-6xl mx-auto">
            <div id="progressBar" class="progress-bar bg-hyperlink-blue h-full transition-all duration-300" style="width: 0%"></div>
        </div>
        <!-- Progress Text -->
        <div id="progressText" class="absolute top-3 left-1/2 transform -translate-x-1/2 text-xs text-gray-600 font-medium hidden">
            <span id="progressCounter">0 of 26</span> questions completed
        </div>
    </div>

    <!-- Main Container -->
    <div class="max-w-3xl mx-auto px-4 pb-8 min-h-screen">
        
        <!-- Welcome Screen -->
        <div id="welcome" class="question-screen fade-in">
            <div class="sm:bg-white sm:rounded-lg sm:border sm:border-gray-200 p-4 sm:p-10 mt-0 sm:mt-8 max-w-2xl mx-auto">
                <h1 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">
                    Get Your Business Sale Readiness Score in 3 Minutes
                </h1>
                <h2 class="text-lg sm:text-xl text-gray-600 mb-6 font-medium">
                    Unlock Your Business Value: AI-Powered Assessment Reveals 90% of Hidden Sale Barriers
                </h2>
                <p class="text-base sm:text-lg text-gray-700 mb-6 leading-relaxed">
                    Get an instant score and AI-generated recommendations based on M&A market data.
                </p>
                <div class="space-y-4 mb-8">
                    <div class="flex items-start">
                        <svg class="w-5 h-5 sm:w-6 sm:h-6 text-green-500 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7"></path>
                        </svg>
                        <span class="text-gray-700 text-sm sm:text-base">26-point analysis completed in under 3 minutes</span>
                    </div>
                    <div class="flex items-start">
                        <svg class="w-5 h-5 sm:w-6 sm:h-6 text-green-500 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7"></path>
                        </svg>
                        <span class="text-gray-700 text-sm sm:text-base">Instant score with specific improvement areas identified</span>
                    </div>
                    <div class="flex items-start">
                        <svg class="w-5 h-5 sm:w-6 sm:h-6 text-green-500 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7"></path>
                        </svg>
                        <span class="text-gray-700 text-sm sm:text-base">Actionable steps to increase your sale price</span>
                    </div>
                </div>
                
                <!-- Industry Selection -->
                <div class="mb-6">
                    <label class="block text-sm sm:text-base font-bold text-gray-700 mb-2">What industry is your business in? *</label>
                    <select id="industry" name="industry" required class="w-full p-6 text-lg font-medium border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white">
                        <option value="">Select your industry</option>
                        <option value="Manufacturing">Manufacturing</option>
                        <option value="Construction">Construction</option>
                        <option value="Retail">Retail</option>
                        <option value="Food & Beverage">Food & Beverage</option>
                        <option value="Healthcare">Healthcare</option>
                        <option value="Professional Services">Professional Services</option>
                        <option value="Technology">Technology</option>
                        <option value="Transportation & Logistics">Transportation & Logistics</option>
                        <option value="Real Estate">Real Estate</option>
                        <option value="Financial Services">Financial Services</option>
                        <option value="Education">Education</option>
                        <option value="Automotive">Automotive</option>
                        <option value="Agriculture">Agriculture</option>
                        <option value="Energy">Energy</option>
                        <option value="Entertainment & Media">Entertainment & Media</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <button onclick="startAssessment()" class="btn-primary w-full py-4 px-6 rounded-xl text-white font-semibold text-base sm:text-lg shadow-lg">
                    Start Assessment →
                </button>
                <p class="text-xs sm:text-sm text-gray-500 mt-4 text-center">
                    No payment required • 100% confidential
                </p>
            </div>
        </div>

        <!-- Revenue Selection Screen -->
        <div id="revenueSelection" class="question-screen hidden">
            <div class="sm:bg-white sm:rounded-lg sm:border sm:border-gray-200 p-4 sm:p-10 mt-0 sm:mt-8 max-w-2xl mx-auto">
                <div class="mb-6">
                    <span class="text-xs sm:text-sm text-orange-600 font-bold uppercase tracking-wider">Business Profile</span>
                    <div class="text-sm text-gray-500 mt-1">Step 1 of 3</div>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-slate-900 mb-6">
                    What is your approximate annual revenue?
                </h2>
                <p class="text-gray-600 mb-8 text-sm sm:text-base">
                    This helps us provide more accurate recommendations for your business size.
                </p>
                <div class="space-y-3">
                    <button onclick="selectRevenue('Under $100K', 50000)" class="revenue-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">Under $100K</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectRevenue('$100K - $500K', 300000)" class="revenue-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">$100K - $500K</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectRevenue('$500K - $1M', 750000)" class="revenue-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">$500K - $1M</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectRevenue('$1M - $2M', 1500000)" class="revenue-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">$1M - $2M</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectRevenue('$2M - $5M', 3500000)" class="revenue-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">$2M - $5M</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectRevenue('$5M - $10M', 7500000)" class="revenue-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">$5M - $10M</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectRevenue('$10M - $25M', 17500000)" class="revenue-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">$10M - $25M</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectRevenue('$25M - $50M', 37500000)" class="revenue-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">$25M - $50M</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectRevenue('Over $50M', 75000000)" class="revenue-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">Over $50M</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Employee Count Selection Screen -->
        <div id="employeeSelection" class="question-screen hidden">
            <div class="sm:bg-white sm:rounded-lg sm:border sm:border-gray-200 p-4 sm:p-10 mt-0 sm:mt-8 max-w-2xl mx-auto">
                <div class="mb-6">
                    <span class="text-xs sm:text-sm text-orange-600 font-bold uppercase tracking-wider">Business Profile</span>
                    <div class="text-sm text-gray-500 mt-1">Step 2 of 3</div>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-slate-900 mb-6">
                    How many employees does your business have?
                </h2>
                <p class="text-gray-600 mb-8 text-sm sm:text-base">
                    Include yourself and any full-time, part-time, or contract workers.
                </p>
                <div class="space-y-3">
                    <button onclick="selectEmployees('Just me', 1)" class="employee-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">Just me (sole proprietor)</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectEmployees('2-5 employees', 3)" class="employee-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">2-5 employees</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectEmployees('6-10 employees', 8)" class="employee-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">6-10 employees</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectEmployees('11-25 employees', 18)" class="employee-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">11-25 employees</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectEmployees('26-50 employees', 38)" class="employee-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">26-50 employees</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectEmployees('51-100 employees', 75)" class="employee-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">51-100 employees</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                    <button onclick="selectEmployees('Over 100 employees', 150)" class="employee-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-gray-900">Over 100 employees</span>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-green-500 transition-colors"></div>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Question Template (Hidden, will be cloned) -->
        <div id="questionTemplate" class="question-screen hidden">
            <div class="sm:bg-white sm:rounded-lg sm:border sm:border-gray-200 p-4 sm:p-8 mt-0 sm:mt-8 fade-in max-w-2xl mx-auto">
                <div class="mb-6">
                    <span class="text-xs sm:text-sm text-hyperlink-blue font-bold uppercase tracking-wider category-label">Category</span>
                    <div class="text-sm text-gray-500 mt-1">
                        Question <span class="current-q">1</span> of <span class="total-q">26</span>
                    </div>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-slate-900 mb-8 leading-snug question-text">
                    Question goes here?
                </h2>
                <div class="space-y-3">
                    <button onclick="answerQuestion(true, event)" class="answer-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all group">
                        <div class="flex items-center pointer-events-none">
                            <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-green-100 group-hover:bg-green-200 flex items-center justify-center mr-4 flex-shrink-0 transition-colors">
                                <svg class="w-5 h-5 sm:w-6 sm:h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-900 text-base">Yes</div>
                                <div class="text-sm text-gray-600 yes-description">Positive indicator</div>
                            </div>
                        </div>
                    </button>
                    <button onclick="answerQuestion(false, event)" class="answer-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-red-500 hover:bg-red-50 transition-all group">
                        <div class="flex items-center pointer-events-none">
                            <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-red-100 group-hover:bg-red-200 flex items-center justify-center mr-4 flex-shrink-0 transition-colors">
                                <svg class="w-5 h-5 sm:w-6 sm:h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-900 text-base">No</div>
                                <div class="text-sm text-gray-600 no-description">Area for improvement</div>
                            </div>
                        </div>
                    </button>
                    <button onclick="answerQuestion(null, event)" class="answer-btn w-full p-4 text-left rounded-xl border-2 border-gray-200 hover:border-gray-400 hover:bg-gray-50 transition-all group">
                        <div class="flex items-center pointer-events-none">
                            <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-gray-100 group-hover:bg-gray-200 flex items-center justify-center mr-4 flex-shrink-0 transition-colors">
                                <svg class="w-5 h-5 sm:w-6 sm:h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <div class="font-semibold text-gray-900 text-base">Not Sure / Not Applicable</div>
                                <div class="text-sm text-gray-600">Skip this question</div>
                            </div>
                        </div>
                    </button>
                </div>
                <button onclick="goBack()" class="mt-6 text-gray-500 hover:text-gray-700 text-sm flex items-center transition-colors">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                    Back
                </button>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results" class="hidden">
            <div class="sm:bg-white sm:rounded-xl sm:shadow-lg p-6 sm:p-8 mt-0 sm:mt-8 fade-in">
                <h2 class="text-3xl font-bold text-slate-900 mb-2">Your Sales Readiness Score</h2>
                <div class="text-6xl font-bold text-orange-600 my-8">
                    <span id="scoreValue">0</span>%
                </div>
                <div id="scoreInterpretation" class="text-lg text-gray-700 mb-4"></div>
                
                <div class="bg-gray-50 rounded-lg p-6 mb-6">
                    <h3 class="text-xl font-semibold text-slate-900 mb-3">Get Your Complete Analysis</h3>
                    <p class="text-gray-700 mb-4">Your personalized report will include:</p>
                    <ul class="space-y-2 text-gray-700 mb-4">
                        <li class="flex items-start">
                            <svg class="w-5 h-5 text-green-500 mt-0.5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <span>Detailed breakdown of each assessment category with specific scores</span>
                        </li>
                        <li class="flex items-start">
                            <svg class="w-5 h-5 text-green-500 mt-0.5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <span>Industry-specific benchmarks and insights for your business sector</span>
                        </li>
                        <li class="flex items-start">
                            <svg class="w-5 h-5 text-green-500 mt-0.5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <span>Priority action plan to address your biggest opportunities</span>
                        </li>
                        <li class="flex items-start">
                            <svg class="w-5 h-5 text-green-500 mt-0.5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <span>Estimated timeline and investment required for improvements</span>
                        </li>
                        <li class="flex items-start">
                            <svg class="w-5 h-5 text-green-500 mt-0.5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <span>Potential valuation impact of implementing our recommendations</span>
                        </li>
                    </ul>
                </div>
                
                <button onclick="showDetailedReport()" class="btn-primary w-full py-4 px-6 rounded-lg text-white font-semibold text-lg">
                    Get My Complete Analysis →
                </button>
                <p class="text-sm text-gray-500 mt-3 text-center">
                    Prepared by experienced M&A professionals • Delivered within 1 business day
                </p>
            </div>
        </div>

        <!-- Lead Capture Form -->
        <div id="leadCapture" class="hidden">
            <div class="sm:bg-white sm:rounded-xl sm:shadow-lg p-6 sm:p-8 mt-0 sm:mt-8 fade-in">
                <h2 class="text-2xl font-bold text-slate-900 mb-2">Get Your Personalized Report</h2>
                <p class="text-gray-600 mb-6">
                    We'll send you a detailed analysis with specific recommendations to improve your business's sale readiness.
                </p>
                <form id="leadForm" onsubmit="submitLeadForm(event)">
                    <input type="text" id="honeypot" name="honeypot" style="position:absolute;left:-9999px;opacity:0;height:0;width:0;border:0;padding:0;margin:0;pointer-events:none" tabindex="-1" autocomplete="new-password" aria-hidden="true" readonly>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Name *</label>
                            <input type="text" name="name" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
                            <input type="email" name="email" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Phone *</label>
                            <input type="tel" name="phone" id="phoneInput" placeholder="(555) 123-4567" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Company Name *</label>
                            <input type="text" name="company" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Company Website</label>
                            <input type="text" name="website" placeholder="yourcompany.com" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Business Location (Zip Code) *</label>
                            <input type="text" name="zipcode" required pattern="[0-9]{5}" placeholder="12345" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                        </div>
                    </div>
                    
                    <!-- reCAPTCHA v3 (Invisible) -->
                    <input type="hidden" id="recaptcha-token" name="recaptcha-token">
                    
                    <button type="submit" id="submitBtn" class="btn-primary w-full py-4 px-6 rounded-lg text-white font-semibold text-lg mt-6">
                        <span id="submitBtnText">Get My Report →</span>
                        <span id="submitBtnLoading" class="hidden">
                            <div class="loading-spinner"></div>
                            Processing Assessment...
                        </span>
                    </button>
                    <p class="text-xs text-gray-500 mt-4 text-center">
                        Your information is 100% confidential and will never be shared.
                    </p>
                </form>
            </div>
        </div>

        <!-- Thank You Screen -->
        <div id="thankYou" class="hidden">
            <div class="sm:bg-white sm:rounded-xl sm:shadow-lg p-6 sm:p-8 mt-0 sm:mt-8 fade-in text-center">
                <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-slate-900 mb-4">Your Report is Being Prepared</h2>
                <p class="text-lg text-gray-700 mb-6">
                    Thank you for completing the assessment! Your personalized analysis is now being reviewed by one of our experienced M&A professionals.
                </p>
                <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6">
                    <h3 class="font-semibold text-orange-800 mb-2">What happens next:</h3>
                    <ul class="text-left text-orange-700 space-y-1">
                        <li>• Our team reviews your responses and industry context</li>
                        <li>• We prepare your customized recommendations</li>
                        <li>• Your complete report arrives in your inbox within 1 business day</li>
                    </ul>
                </div>
                <p class="text-gray-600 mb-4">
                    <strong>Can't wait?</strong> One of our senior advisors may reach out to discuss your preliminary results and answer any immediate questions about your business sale preparation.
                </p>
                <p class="text-sm text-gray-500">
                    Check your email (including spam folder) for your detailed analysis report.
                </p>
            </div>
        </div>
    </div>

    <!-- Processing Overlay -->
    <div id="processingOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md mx-4 text-center">
            <div class="loading-spinner mx-auto mb-4" style="border-top-color: #000; width: 40px; height: 40px;"></div>
            <h3 class="text-xl font-semibold text-gray-900 mb-2">Processing Your Assessment</h3>
            <div id="processingSteps" class="text-sm text-gray-600 space-y-1">
                <div id="step1" class="flex items-center justify-center">
                    <span class="inline-block w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                    Analyzing your responses
                </div>
                <div id="step2" class="flex items-center justify-center opacity-50">
                    <span class="inline-block w-2 h-2 bg-gray-300 rounded-full mr-2"></span>
                    Generating AI recommendations
                </div>
                <div id="step3" class="flex items-center justify-center opacity-50">
                    <span class="inline-block w-2 h-2 bg-gray-300 rounded-full mr-2"></span>
                    Preparing your report
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-4">This may take 10-15 seconds</p>
        </div>
    </div>

    <script>
        // Assessment Data
        const categories = [
            {
                name: "Transferability Risk",
                weight: 0.30,
                questions: [
                    {
                        text: "Does the business operate without requiring the owner's unique skills or knowledge?",
                        weight: 0.35,
                        yesText: "Business runs on systems",
                        noText: "Owner is the business"
                    },
                    {
                        text: "Are key customer relationships maintained by at least two non-owner employees?",
                        weight: 0.20,
                        yesText: "Relationships are institutional",
                        noText: "Owner holds relationships"
                    },
                    {
                        text: "Would the business survive losing any single employee (including the owner)?",
                        weight: 0.15,
                        yesText: "No single point of failure",
                        noText: "Dangerous dependencies"
                    },
                    {
                        text: "Is the owner working less than 25 hours per week in the business?",
                        weight: 0.10,
                        yesText: "Business runs itself",
                        noText: "Owner is overinvolved"
                    },
                    {
                        text: "Are all critical processes documented in writing?",
                        weight: 0.10,
                        yesText: "Trainable systems",
                        noText: "Tribal knowledge"
                    },
                    {
                        text: "Could the business operate profitably with an absentee owner for 60+ days?",
                        weight: 0.10,
                        yesText: "True business",
                        noText: "Glorified job"
                    }
                ]
            },
            {
                name: "Growth Track Record",
                weight: 0.20,
                questions: [
                    {
                        text: "Did the company grow revenue year-over-year in the most recent 12 months?",
                        weight: 0.40,
                        yesText: "Growing now",
                        noText: "Stagnant or declining"
                    },
                    {
                        text: "Did revenue increase in at least 4 of the last 5 years?",
                        weight: 0.25,
                        yesText: "Proven growth",
                        noText: "Sporadic performance"
                    },
                    {
                        text: "Do you feel your business has grown faster than most of your competitors?",
                        weight: 0.20,
                        yesText: "Taking share",
                        noText: "Losing ground"
                    },
                    {
                        text: "Do you regularly attract new customers to replace any you might lose?",
                        weight: 0.15,
                        yesText: "Healthy new business",
                        noText: "Aging customer base"
                    }
                ]
            },
            {
                name: "Market Dynamics",
                weight: 0.15,
                questions: [
                    {
                        text: "Is demand for your products/services generally increasing each year?",
                        weight: 0.40,
                        yesText: "Growth industry",
                        noText: "Stagnant/declining"
                    },
                    {
                        text: "Would it take a new competitor more than $100k to start competing with you?",
                        weight: 0.30,
                        yesText: "Protected",
                        noText: "Easy entry"
                    },
                    {
                        text: "Would it be difficult for someone to replace your service with a computer or app?",
                        weight: 0.30,
                        yesText: "Disruption resistant",
                        noText: "Vulnerable"
                    }
                ]
            },
            {
                name: "Business Model Attractiveness",
                weight: 0.15,
                questions: [
                    {
                        text: "Is your revenue predictable through contracts, subscriptions, or repeat customers?",
                        weight: 0.35,
                        yesText: "Stable revenue",
                        noText: "Unpredictable"
                    },
                    {
                        text: "After paying all expenses, do you typically keep more than 15 cents of every dollar in revenue?",
                        weight: 0.25,
                        yesText: "Healthy margins",
                        noText: "Thin margins"
                    },
                    {
                        text: "Did the business revenue drop less than 15% during 2008 or 2020?",
                        weight: 0.20,
                        yesText: "Recession resistant",
                        noText: "Cyclical"
                    },
                    {
                        text: "Is your equipment investment less than 50% of annual revenue?",
                        weight: 0.20,
                        yesText: "Asset light",
                        noText: "Capital intensive"
                    }
                ]
            },
            {
                name: "Financial Integrity & Operations",
                weight: 0.10,
                questions: [
                    {
                        text: "Are your financial records clean and prepared by a professional?",
                        weight: 0.30,
                        yesText: "Bankable",
                        noText: "Requires normalization"
                    },
                    {
                        text: "Does no single customer represent more than 15% of revenue?",
                        weight: 0.25,
                        yesText: "Diversified",
                        noText: "Concentration risk"
                    },
                    {
                        text: "Do you keep personal expenses separate from business expenses?",
                        weight: 0.20,
                        yesText: "Clean operations",
                        noText: "Lifestyle business"
                    },
                    {
                        text: "Has a CPA reviewed or prepared your financial statements?",
                        weight: 0.15,
                        yesText: "Verified",
                        noText: "Unverified"
                    },
                    {
                        text: "Do most of your customers come back year after year?",
                        weight: 0.10,
                        yesText: "Sticky customers",
                        noText: "High churn"
                    }
                ]
            },
            {
                name: "Competitive Moat",
                weight: 0.10,
                questions: [
                    {
                        text: "Do you have 4.0+ stars online OR can you provide 10+ positive customer references?",
                        weight: 0.30,
                        yesText: "Strong reputation",
                        noText: "Reputation issues"
                    },
                    {
                        text: "Do potential customers regularly contact you without you having to chase them?",
                        weight: 0.25,
                        yesText: "Strong marketing",
                        noText: "Weak presence"
                    },
                    {
                        text: "Can you charge 10%+ more than competitors and keep customers?",
                        weight: 0.25,
                        yesText: "Premium position",
                        noText: "Commodity"
                    },
                    {
                        text: "Have you won 5+ new accounts from competitors in the last 12 months?",
                        weight: 0.20,
                        yesText: "Winning",
                        noText: "Not competing"
                    }
                ]
            }
        ];

        // No hardcoded credentials - all API calls go through our secure Netlify function

        // State Management
        let currentCategoryIndex = 0;
        let currentQuestionIndex = 0;
        let answers = [];
        let totalQuestions = categories.reduce((sum, cat) => sum + cat.questions.length, 0);
        let currentQuestionNumber = 0;
        let assessmentStartTime = null;
        let businessInfo = {};

        // Safe analytics tracking
        function trackEvent(eventName, parameters) {
            if (typeof gtag !== 'undefined') {
                gtag('event', eventName, parameters);
            }
        }
        
        function trackFBEvent(eventName, parameters) {
            if (typeof fbq !== 'undefined') {
                fbq('track', eventName, parameters);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Track page view
            trackEvent('page_view', {
                page_title: 'Sales Readiness Assessment',
                page_location: window.location.href
            });
            
            // Try to restore saved progress
            restoreProgress();
            
            // Set up engagement tracking
            setupEngagementTracking();
        });
        
        // Engagement tracking setup
        function setupEngagementTracking() {
            let engagedTracked = false;
            let abandonmentTracked = false;
            let pageLoadTime = Date.now();
            
            // Track engaged user at 60 seconds
            setTimeout(() => {
                if (!engagedTracked) {
                    trackEvent('engaged_user', {
                        time_on_page: 60
                    });
                    engagedTracked = true;
                }
            }, 60000);
            
            // Track quick abandonment at 30 seconds if user hasn't started
            setTimeout(() => {
                if (!abandonmentTracked && !assessmentStartTime) {
                    trackEvent('quick_abandonment', {
                        time_on_page: 30
                    });
                    abandonmentTracked = true;
                }
            }, 30000);
            
            // Track when user leaves page
            window.addEventListener('beforeunload', function() {
                const timeOnPage = Math.floor((Date.now() - pageLoadTime) / 1000);
                trackEvent('page_exit', {
                    time_on_page: timeOnPage,
                    assessment_started: !!assessmentStartTime,
                    answers_given: answers.length
                });
            });
        }

        function startAssessment() {
            // Validate industry selection
            const industry = document.getElementById('industry').value;
            
            if (!industry) {
                alert('Please select your industry before starting the assessment.');
                return;
            }
            
            // Store business information
            businessInfo = {
                industry: industry,
                website: null, // Will be set from lead form
                revenue: null,
                revenueNumeric: null,
                employees: null,
                employeesNumeric: null
            };
            
            document.getElementById('welcome').classList.add('hidden');
            assessmentStartTime = Date.now(); // Track start time for spam protection
            showScreen('revenueSelection');
            
            // Save progress
            saveProgress();
            
            // Track revenue selection start
            trackEvent('revenue_selection_start', {
                industry: industry
            });
            trackEvent('begin_checkout', {
                value: 0,
                currency: 'USD',
                items: [{
                    item_name: 'Sales Readiness Assessment',
                    item_category: 'Lead Generation'
                }],
                custom_parameter_2: industry
            });
        }
        
        function selectRevenue(displayText, numericValue) {
            businessInfo.revenue = displayText;
            businessInfo.revenueNumeric = numericValue;
            
            // Add visual feedback
            document.querySelectorAll('.revenue-btn').forEach(btn => {
                btn.classList.remove('border-green-500', 'bg-green-50');
                btn.classList.add('border-gray-200');
                btn.querySelector('.w-6').classList.remove('bg-green-500');
                btn.querySelector('.w-6').classList.add('border-gray-300');
            });
            
            event.target.closest('.revenue-btn').classList.add('border-green-500', 'bg-green-50');
            event.target.closest('.revenue-btn').querySelector('.w-6').classList.add('bg-green-500');
            event.target.closest('.revenue-btn').querySelector('.w-6').classList.remove('border-gray-300');
            
            // Auto-advance after selection
            setTimeout(() => {
                // Track revenue selection completion
                trackEvent('revenue_selection_complete', {
                    revenue_range: displayText,
                    revenue_numeric: numericValue
                });
                
                showScreen('employeeSelection');
                
                // Track employee selection start
                trackEvent('employee_selection_start', {
                    revenue_range: displayText
                });
                
                // Save progress
                saveProgress();
            }, 500);
        }
        
        function selectEmployees(displayText, numericValue) {
            businessInfo.employees = displayText;
            businessInfo.employeesNumeric = numericValue;
            
            // Add visual feedback
            document.querySelectorAll('.employee-btn').forEach(btn => {
                btn.classList.remove('border-green-500', 'bg-green-50');
                btn.classList.add('border-gray-200');
                btn.querySelector('.w-6').classList.remove('bg-green-500');
                btn.querySelector('.w-6').classList.add('border-gray-300');
            });
            
            event.target.closest('.employee-btn').classList.add('border-green-500', 'bg-green-50');
            event.target.closest('.employee-btn').querySelector('.w-6').classList.add('bg-green-500');
            event.target.closest('.employee-btn').querySelector('.w-6').classList.remove('border-gray-300');
            
            // Auto-advance after selection
            setTimeout(() => {
                // Track employee selection completion
                trackEvent('employee_selection_complete', {
                    employee_range: displayText,
                    employee_numeric: numericValue
                });
                
                showQuestion();
                // Save progress
                saveProgress();
            }, 500);
        }
        
        function showScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.question-screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            
            // Show requested screen
            document.getElementById(screenId).classList.remove('hidden');
        }

        function showQuestion() {
            const category = categories[currentCategoryIndex];
            const question = category.questions[currentQuestionIndex];
            currentQuestionNumber = getCurrentQuestionNumber();
            
            
            // Hide all screens
            document.querySelectorAll('.question-screen').forEach(el => el.classList.add('hidden'));
            document.getElementById('results').classList.add('hidden');
            document.getElementById('leadCapture').classList.add('hidden');
            document.getElementById('thankYou').classList.add('hidden');
            
            // Remove any existing question display
            const existing = document.getElementById('currentQuestion');
            if (existing) {
                existing.remove();
            }
            
            // Clone template and prepare new question
            const template = document.getElementById('questionTemplate');
            const questionDiv = template.cloneNode(true);
            questionDiv.id = 'currentQuestion';
            questionDiv.classList.remove('hidden');
            questionDiv.classList.add('fade-in');
            
            // Reset all button states to prevent carryover on mobile
            questionDiv.querySelectorAll('.answer-btn').forEach(btn => {
                btn.classList.remove('border-green-500', 'bg-green-50', 'border-red-500', 'bg-red-50', 'border-gray-400', 'bg-gray-50');
                btn.classList.add('border-gray-200');
                // Reset button icon backgrounds
                const iconDiv = btn.querySelector('.w-10, .w-12');
                if (iconDiv) {
                    iconDiv.classList.remove('bg-green-200', 'bg-red-200', 'bg-gray-200');
                    if (btn.classList.contains('hover:border-green-500')) {
                        iconDiv.classList.add('bg-green-100');
                    } else if (btn.classList.contains('hover:border-red-500')) {
                        iconDiv.classList.add('bg-red-100');
                    } else {
                        iconDiv.classList.add('bg-gray-100');
                    }
                }
            });
            
            // Update content
            questionDiv.querySelector('.category-label').textContent = category.name.toUpperCase();
            questionDiv.querySelector('.current-q').textContent = currentQuestionNumber;
            questionDiv.querySelector('.total-q').textContent = totalQuestions;
            questionDiv.querySelector('.question-text').textContent = question.text;
            questionDiv.querySelector('.yes-description').textContent = question.yesText;
            questionDiv.querySelector('.no-description').textContent = question.noText;
            
            // Add to DOM
            const container = document.querySelector('.max-w-3xl');
            if (!container) {
                console.error('Container not found! Looking for .max-w-3xl');
                return;
            }
            container.appendChild(questionDiv);
            
            // Update progress
            updateProgress();
            
            // Reset focus to prevent mobile highlight issue
            document.body.focus();
            
            // Scroll to top smoothly
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function getCurrentQuestionNumber() {
            let num = 0;
            for (let i = 0; i < currentCategoryIndex; i++) {
                num += categories[i].questions.length;
            }
            return num + currentQuestionIndex + 1;
        }

        function answerQuestion(answer, event) {
            // Prevent default and stop propagation
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            // Remove focus from the clicked button (fixes mobile highlight issue)
            if (document.activeElement) {
                document.activeElement.blur();
            }
            
            // Store answer
            answers.push({
                category: currentCategoryIndex,
                question: currentQuestionIndex,
                answer: answer
            });
            
            // Save progress after each answer
            saveProgress();
            
            // Track answer
            trackEvent('assessment_answer', {
                question_number: currentQuestionNumber,
                category: categories[currentCategoryIndex].name,
                answer: answer === true ? 'yes' : answer === false ? 'no' : 'skip'
            });
            
            // Track progress every 5 questions
            if (answers.length % 5 === 0) {
                trackEvent('assessment_progress', {
                    questions_answered: answers.length,
                    total_questions: totalQuestions,
                    progress_percentage: Math.round((answers.length / totalQuestions) * 100)
                });
            }
            
            // Move to next question
            currentQuestionIndex++;
            if (currentQuestionIndex >= categories[currentCategoryIndex].questions.length) {
                // Track category completion
                trackEvent('category_complete', {
                    category_name: categories[currentCategoryIndex].name,
                    category_index: currentCategoryIndex,
                    questions_in_category: categories[currentCategoryIndex].questions.length
                });
                
                currentCategoryIndex++;
                currentQuestionIndex = 0;
            }
            
            if (currentCategoryIndex >= categories.length) {
                calculateResults();
            } else {
                // Small delay to ensure blur completes before showing next question
                setTimeout(() => {
                    showQuestion();
                }, 50);
            }
        }

        function goBack() {
            if (answers.length > 0) {
                // Remove last answer
                answers.pop();
                
                // Move back one question
                currentQuestionIndex--;
                if (currentQuestionIndex < 0) {
                    currentCategoryIndex--;
                    if (currentCategoryIndex >= 0) {
                        currentQuestionIndex = categories[currentCategoryIndex].questions.length - 1;
                    }
                }
                
                // Check if we're back at the beginning
                if (currentCategoryIndex < 0) {
                    // Reset to beginning
                    currentCategoryIndex = 0;
                    currentQuestionIndex = 0;
                    
                    // Hide current question and show welcome
                    const currentQuestion = document.getElementById('currentQuestion');
                    if (currentQuestion) {
                        currentQuestion.remove();
                    }
                    document.getElementById('welcome').classList.remove('hidden');
                    
                    // Reset progress bar
                    document.getElementById('progressBar').style.width = '0%';
                } else {
                    // Show previous question
                    showQuestion();
                }
            } else {
                // No answers yet, ensure we're on welcome screen
                const currentQuestion = document.getElementById('currentQuestion');
                if (currentQuestion) {
                    currentQuestion.remove();
                }
                document.getElementById('welcome').classList.remove('hidden');
                document.getElementById('progressBar').style.width = '0%';
            }
        }

        function updateProgress() {
            const progress = (currentQuestionNumber / totalQuestions) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            // Update progress text
            const progressText = document.getElementById('progressText');
            const progressCounter = document.getElementById('progressCounter');
            
            if (currentQuestionNumber > 0) {
                progressText.classList.remove('hidden');
                progressCounter.textContent = `${currentQuestionNumber} of ${totalQuestions}`;
            } else {
                progressText.classList.add('hidden');
            }
        }

        function calculateResults() {
            let totalScore = 0;
            
            categories.forEach((category, catIndex) => {
                let categoryScore = 0;
                category.questions.forEach((question, qIndex) => {
                    const answer = answers.find(a => 
                        a.category === catIndex && a.question === qIndex
                    );
                    if (answer && answer.answer === true) {
                        categoryScore += question.weight;
                    }
                });
                totalScore += categoryScore * category.weight;
            });
            
            const finalScore = Math.round(totalScore * 100);
            showResults(finalScore);
        }

        function showResults(score) {
            // Hide current question if exists
            const currentQuestion = document.getElementById('currentQuestion');
            if (currentQuestion) {
                currentQuestion.classList.add('hidden');
            }
            
            // Show results
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('progressBar').style.width = '100%';
            
            // Animate score
            const scoreElement = document.getElementById('scoreValue');
            let displayScore = 0;
            const increment = score / 20;
            const timer = setInterval(() => {
                displayScore += increment;
                if (displayScore >= score) {
                    displayScore = score;
                    clearInterval(timer);
                }
                scoreElement.textContent = Math.round(displayScore);
            }, 50);
            
            let interpretation = '';
            if (score >= 80) {
                interpretation = "Excellent! Your business is in the top quartile for sale readiness. You're positioned for a premium valuation.";
            } else if (score >= 60) {
                interpretation = "Good position! Your business is above average in sale readiness, with some areas for improvement.";
            } else if (score >= 40) {
                interpretation = "Average readiness. There are significant opportunities to improve your business value before selling.";
            } else if (score >= 20) {
                interpretation = "Below average readiness. Consider implementing improvements before going to market.";
            } else {
                interpretation = "Your business needs significant improvements to be market-ready. Let's discuss a preparation strategy.";
            }
            
            document.getElementById('scoreInterpretation').textContent = interpretation;
            
            // Track completion
            trackEvent('assessment_complete', {
                score: score,
                score_category: score >= 80 ? 'premium' : score >= 60 ? 'above_average' : score >= 40 ? 'average' : score >= 20 ? 'below_average' : 'needs_improvement',
                custom_parameter_1: score,
                custom_parameter_2: businessInfo.industry
            });
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }


        function showDetailedReport() {
            document.getElementById('results').classList.add('hidden');
            document.getElementById('leadCapture').classList.remove('hidden');
            
            trackEvent('begin_lead_capture');
            
            // Track form field interactions
            setupFormTracking();
        }
        
        function setupFormTracking() {
            const formFields = ['name', 'email', 'phone', 'company', 'website', 'zipcode'];
            
            formFields.forEach(fieldName => {
                const field = document.querySelector(`input[name="${fieldName}"]`);
                if (field) {
                    field.addEventListener('focus', () => {
                        trackEvent('form_field_focus', {
                            field_name: fieldName
                        });
                    });
                    
                    field.addEventListener('blur', () => {
                        if (field.validity.valueMissing || !field.validity.valid) {
                            trackEvent('form_validation_error', {
                                field_name: fieldName,
                                error_type: field.validity.valueMissing ? 'required' : 'invalid'
                            });
                        }
                    });
                }
            });
            
            // Set up phone number masking
            setupPhoneMask();
        }
        
        function setupPhoneMask() {
            const phoneInput = document.getElementById('phoneInput');
            if (!phoneInput) return;
            
            phoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, ''); // Remove all non-digits
                
                if (value.length >= 6) {
                    // Format as (XXX) XXX-XXXX
                    value = `(${value.slice(0, 3)}) ${value.slice(3, 6)}-${value.slice(6, 10)}`;
                } else if (value.length >= 3) {
                    // Format as (XXX) XXX
                    value = `(${value.slice(0, 3)}) ${value.slice(3)}`;
                } else if (value.length > 0) {
                    // Format as (XXX
                    value = `(${value}`;
                }
                
                e.target.value = value;
            });
            
            // Handle backspace to remove formatting
            phoneInput.addEventListener('keydown', function(e) {
                if (e.key === 'Backspace') {
                    let value = e.target.value;
                    // If we're deleting a formatting character, delete the digit before it too
                    if (value.endsWith(') ') || value.endsWith('-')) {
                        e.preventDefault();
                        e.target.value = value.slice(0, -2);
                        // Trigger input event to reformat
                        e.target.dispatchEvent(new Event('input'));
                    }
                }
            });
            
            // Validation
            phoneInput.addEventListener('blur', function(e) {
                const value = e.target.value.replace(/\D/g, '');
                if (value.length !== 10) {
                    e.target.setCustomValidity('Please enter a valid 10-digit US phone number');
                } else {
                    e.target.setCustomValidity('');
                }
            });
        }

        async function submitLeadForm(event) {
            event.preventDefault();
            
            // Show loading state immediately
            showLoadingState();
            
            const formData = new FormData(event.target);
            const timeSpent = assessmentStartTime ? Math.floor((Date.now() - assessmentStartTime) / 1000) : 0;
            
            // Spam protection - honeypot check
            const honeypot = formData.get('honeypot');
            if (honeypot) {
                // Silent fail for spam protection
                hideLoadingState();
                return;
            }
            
            // reCAPTCHA v3 validation
            let recaptchaResponse;
            try {
                recaptchaResponse = await grecaptcha.execute('6LdrH68rAAAAADuJOKxj-FLpKB8fUNFX-I6mYeAA', {action: 'submit_assessment'});
                
                // Track successful reCAPTCHA completion
                trackEvent('recaptcha_completed', {
                    action: 'submit_assessment'
                });
            } catch (error) {
                hideLoadingState();
                
                // Track reCAPTCHA failure
                trackEvent('recaptcha_failed', {
                    error: error.message || 'Unknown error'
                });
                
                alert('reCAPTCHA verification failed. Please try again.');
                return;
            }
            
            if (timeSpent < 30) {
                hideLoadingState();
                alert('Please take your time to complete the assessment properly.');
                return;
            }
            
            // Prepare data for Supabase
            const submissionData = {
                name: formData.get('name'),
                email: formData.get('email'),
                company: formData.get('company'),
                phone: formData.get('phone') ? formData.get('phone').replace(/\D/g, '') : null, // Store digits only
                industry: businessInfo.industry,
                website: formData.get('website') || null,
                zipcode: formData.get('zipcode'),
                revenue: businessInfo.revenue,
                revenue_numeric: businessInfo.revenueNumeric,
                employees: businessInfo.employees,
                employees_numeric: businessInfo.employeesNumeric,
                score: parseInt(document.getElementById('scoreValue').textContent),
                responses: answers,
                time_spent: timeSpent,
                user_agent: navigator.userAgent,
                referrer: document.referrer,
                recaptcha_token: recaptchaResponse,
                ip_address: null // Will be set by server if needed
            };
            
            try {
                // Track processing start
                const processingStartTime = Date.now();
                trackEvent('processing_started', {
                    assessment_score: parseInt(document.getElementById('scoreValue').textContent)
                });
                
                // Step 2: AI Processing
                setTimeout(() => updateProcessingStep(2), 2000);
                
                // Submit to our secure Netlify function
                const response = await fetch('/.netlify/functions/process-assessment', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(submissionData)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                
                // Track processing completion
                const processingTime = Date.now() - processingStartTime;
                trackEvent('processing_completed', {
                    processing_time_ms: processingTime,
                    processing_time_seconds: Math.round(processingTime / 1000)
                });
                
                // Step 3: Report preparation
                setTimeout(() => updateProcessingStep(3), 500);
                
                // Track conversion
                trackEvent('generate_lead', {
                    currency: 'USD',
                    value: 100,
                    custom_parameter_1: parseInt(document.getElementById('scoreValue').textContent),
                    custom_parameter_2: businessInfo.industry
                });
                
                trackFBEvent('Lead', {
                    currency: 'USD',
                    value: 100
                });
                
                // Small delay to show final step
                setTimeout(() => {
                    hideLoadingState();
                    // Clear saved progress since assessment is complete
                    clearProgress();
                    // Show thank you
                    document.getElementById('leadCapture').classList.add('hidden');
                    document.getElementById('thankYou').classList.remove('hidden');
                }, 1000);
                
            } catch (error) {
                console.error('Error submitting lead:', error);
                
                // Track processing failure
                trackEvent('processing_failed', {
                    error_message: error.message || 'Unknown error',
                    assessment_score: parseInt(document.getElementById('scoreValue').textContent)
                });
                
                hideLoadingState();
                alert('There was an error submitting your information. Please try again or contact us directly.');
            }
        }
        
        // Loading state functions
        function showLoadingState() {
            // Disable submit button and show loading
            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            const submitBtnLoading = document.getElementById('submitBtnLoading');
            
            submitBtn.disabled = true;
            submitBtn.classList.add('btn-loading');
            submitBtnText.classList.add('hidden');
            submitBtnLoading.classList.remove('hidden');
            
            // Show processing overlay
            document.getElementById('processingOverlay').classList.remove('hidden');
            
            // Reset all steps
            resetProcessingSteps();
        }
        
        function hideLoadingState() {
            // Re-enable submit button
            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            const submitBtnLoading = document.getElementById('submitBtnLoading');
            
            submitBtn.disabled = false;
            submitBtn.classList.remove('btn-loading');
            submitBtnText.classList.remove('hidden');
            submitBtnLoading.classList.add('hidden');
            
            // Hide processing overlay
            document.getElementById('processingOverlay').classList.add('hidden');
        }
        
        function resetProcessingSteps() {
            // Reset to step 1 active
            document.getElementById('step1').classList.remove('opacity-50');
            document.getElementById('step1').querySelector('.w-2').classList.remove('bg-gray-300');
            document.getElementById('step1').querySelector('.w-2').classList.add('bg-green-500');
            
            document.getElementById('step2').classList.add('opacity-50');
            document.getElementById('step2').querySelector('.w-2').classList.add('bg-gray-300');
            document.getElementById('step2').querySelector('.w-2').classList.remove('bg-green-500');
            
            document.getElementById('step3').classList.add('opacity-50');
            document.getElementById('step3').querySelector('.w-2').classList.add('bg-gray-300');
            document.getElementById('step3').querySelector('.w-2').classList.remove('bg-green-500');
        }
        
        function updateProcessingStep(step) {
            if (step === 2) {
                document.getElementById('step2').classList.remove('opacity-50');
                document.getElementById('step2').querySelector('.w-2').classList.remove('bg-gray-300');
                document.getElementById('step2').querySelector('.w-2').classList.add('bg-green-500');
            } else if (step === 3) {
                document.getElementById('step3').classList.remove('opacity-50');
                document.getElementById('step3').querySelector('.w-2').classList.remove('bg-gray-300');
                document.getElementById('step3').querySelector('.w-2').classList.add('bg-green-500');
            }
        }
        
        // Progress saving and restoration
        function saveProgress() {
            const progress = {
                currentCategoryIndex,
                currentQuestionIndex,
                answers,
                businessInfo,
                assessmentStartTime,
                currentQuestionNumber,
                timestamp: Date.now()
            };
            
            try {
                sessionStorage.setItem('assessmentProgress', JSON.stringify(progress));
            } catch (error) {
                // Silently fail if sessionStorage is not available
            }
        }
        
        function restoreProgress() {
            try {
                const savedProgress = sessionStorage.getItem('assessmentProgress');
                if (!savedProgress) return;
                
                const progress = JSON.parse(savedProgress);
                
                // Check if progress is recent (within 24 hours)
                const hoursSinceLastSave = (Date.now() - progress.timestamp) / (1000 * 60 * 60);
                if (hoursSinceLastSave > 24) {
                    clearProgress();
                    return;
                }
                
                // Restore state
                currentCategoryIndex = progress.currentCategoryIndex || 0;
                currentQuestionIndex = progress.currentQuestionIndex || 0;
                answers = progress.answers || [];
                businessInfo = progress.businessInfo || {};
                assessmentStartTime = progress.assessmentStartTime || null;
                currentQuestionNumber = progress.currentQuestionNumber || 0;
                
                // Show restoration notification and continue from saved point
                if (answers.length > 0 || Object.keys(businessInfo).length > 0) {
                    // Track progress restoration
                    trackEvent('progress_restored', {
                        answers_restored: answers.length,
                        time_since_save: Math.round(hoursSinceLastSave * 60), // minutes
                        business_info_complete: !!(businessInfo.industry && businessInfo.revenue && businessInfo.employees)
                    });
                    
                    showRestorationNotification();
                    
                    // Restore industry selection if available
                    if (businessInfo.industry) {
                        document.getElementById('industry').value = businessInfo.industry;
                    }
                    
                    // Resume from the appropriate screen
                    if (businessInfo.industry && !businessInfo.revenue) {
                        document.getElementById('welcome').classList.add('hidden');
                        showScreen('revenueSelection');
                    } else if (businessInfo.revenue && !businessInfo.employees) {
                        document.getElementById('welcome').classList.add('hidden');
                        showScreen('employeeSelection');
                    } else if (businessInfo.employees && answers.length < totalQuestions) {
                        document.getElementById('welcome').classList.add('hidden');
                        showQuestion();
                    }
                    
                    // Update progress bar
                    updateProgress();
                }
            } catch (error) {
                // If there's an error, clear the corrupted progress
                clearProgress();
            }
        }
        
        function clearProgress() {
            try {
                sessionStorage.removeItem('assessmentProgress');
            } catch (error) {
                // Silently fail if sessionStorage is not available
            }
        }
        
        function showRestorationNotification() {
            // Create a temporary notification
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-100 border border-green-300 text-green-800 px-4 py-3 rounded-lg shadow-lg z-50 max-w-sm';
            notification.innerHTML = `
                <div class="flex items-start">
                    <svg class="w-5 h-5 mr-2 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div class="flex-1">
                        <div class="font-medium">Progress Restored</div>
                        <div class="text-sm mb-2">Continuing from where you left off</div>
                        <button onclick="startOver()" class="text-xs underline hover:no-underline">Start over instead</button>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-2 text-green-600 hover:text-green-800">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 8 seconds (longer since there's a start over option)
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 8000);
        }
        
        function startOver() {
            // Track fresh start choice
            trackEvent('fresh_start_chosen', {
                previous_answers: answers.length,
                previous_business_info: Object.keys(businessInfo).length
            });
            
            // Clear progress and reload page
            clearProgress();
            window.location.reload();
        }
    </script>

    <!-- Footer -->
    <footer class="bg-dark-anchor text-white py-12 mt-16">
        <div class="max-w-6xl mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-5 gap-12 items-start">
                <!-- Company Info (wider column) -->
                <div class="md:col-span-3">
                    <h2 class="text-4xl font-medium text-white mb-4 font-headline">Arx Brokers</h2>
                    <p class="text-sm text-bright-white leading-relaxed font-body max-w-md">
                        Arx Brokers is a sell-side business brokerage and mergers and acquisitions advisory firm for business owners with $1M - $25M in sales or more than $300k in EBITDA.
                    </p>
                </div>
                
                <!-- Headquarters -->
                <div class="md:ml-4">
                    <h3 class="text-lg font-medium text-white mb-4 font-headline">Headquarters</h3>
                    <div class="text-sm text-cool-gray font-body">
                        <p>2900 NW Clearwater Dr.</p>
                        <p>Bend, OR 97703</p>
                    </div>
                </div>
                
                <!-- Contact -->
                <div>
                    <h3 class="text-lg font-medium text-white mb-4 font-headline">Contact</h3>
                    <div class="text-sm text-cool-gray font-body">
                        <p><a href="mailto:sales@arxbrokers.com" class="hover:text-white transition-colors underline">sales@arxbrokers.com</a></p>
                        <p><a href="tel:8558582130" class="hover:text-white transition-colors underline">(855) 858-2130</a></p>
                    </div>
                </div>
            </div>
            
            <!-- Bottom Section -->
            <div class="mt-12 pt-6">
                <div class="text-left">
                    <a href="https://arxbrokers.com/privacy" class="text-sm text-cool-gray hover:text-white transition-colors underline font-body">Privacy Policy</a>
                </div>
            </div>
        </div>
    </footer>

</body>
</html>